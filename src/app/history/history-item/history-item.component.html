<div class="history-item">
  <div class="history-item-avatar">
    <div>
      <img *ngIf="historyItem.trelloHistoryDataObj.memberCreator.avatarUrl"
        src="{{historyItem.trelloHistoryDataObj.memberCreator.avatarUrl}}/170.png"
        [title]="historyItem.trelloHistoryDataObj.memberCreator.fullName">
      <span
        *ngIf="!historyItem.trelloHistoryDataObj.memberCreator.avatarUrl">{{historyItem.trelloHistoryDataObj.memberCreator.initials}}</span>
    </div>
  </div>
  <div class="history-item-details">
    <div class="history-item-changes">
      <div class="history-item-changes-title">
        <strong>{{historyItem.updateType}}</strong> {{updateVerb}} by
        <strong>{{historyItem.trelloHistoryDataObj.memberCreator.fullName}}</strong>
        <div *ngIf="historyItem.isNew" class="badge badge-warning"
          title="This change occurred after your last viewing of this card's history">New</div>
      </div>
      <div class="history-item-changes-new" (click)="toggleNewValueCollapse()"
        [ngClass]="{'toggle-collapse' : historyItem.newValue?.length > MAX_VALUE_DISPLAY_LENGTH}">
        {{newValueCollapsed ? (historyItem.newValue | stringTruncate:MAX_VALUE_DISPLAY_LENGTH:'...') : historyItem.newValue}}
      </div>
      <div class="history-item-changes-old" (click)="toggleOldValueCollapse()"
        [ngClass]="{'toggle-collapse' : historyItem.oldValue?.length > MAX_VALUE_DISPLAY_LENGTH, 'history-item-changes-old-expanded': !oldValueCollapsed}">
        {{oldValueCollapsed ? (historyItem.oldValue | stringTruncate:MAX_VALUE_DISPLAY_LENGTH:'...') : historyItem.oldValue}}
      </div>
    </div>
    <div class="history-item-misc">
      <div>
        <strong>{{historyItem.trelloHistoryDataObj.date | date: 'mediumDate'}}</strong>
        <small>&nbsp;at&nbsp;</small>
        <strong>{{historyItem.trelloHistoryDataObj.date | date: 'mediumTime'}}</strong>
        <div class="history-item-misc-lane"
          title="This change occurred while in {{historyItem.trelloHistoryDataObj.data.list.name}}">
          {{historyItem.trelloHistoryDataObj.data.list.name}}
        </div>
      </div>
    </div>
  </div>
</div>